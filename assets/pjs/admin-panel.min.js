(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

var data = {
    pages: [],
    onRequest: false,
    pageTitle: "",
    pageSubtitle: "",
    pageRoute: "",
    pageSearch: ""
};

var page = new Vue({
    el: '#pages_pane',
    data: data,
    methods: {
        getPages: function getPages() {
            if (data.onRequest) return false;

            data.onRequest = true;
            $.post('/api/pages', {
                exec: 'request_pages'
            }, null, 'json').then(function (r) {
                if ('erro' in r) {
                    simpleAlert.show({
                        message: 'Houve um problema ao carregar suas páginas..'
                    });
                } else {
                    data.pages = r;
                }
                data.onRequest = false;
            });
        },
        createPage: function createPage() {
            if (data.onRequest || data.pageRoute.length < 3) return simpleAlert.show({
                message: 'Sua rota necessita de ao menos três caracteres!'
            });

            data.onRequest = true;
            $.post('/api/pages', {
                exec: 'create_page',
                page: {
                    title: data.pageTitle,
                    subtitle: data.pageSubtitle,
                    route: data.pageRoute
                }
            }, null, 'json').then(function (r) {
                if ('erro' in r) {
                    simpleAlert.show({
                        message: 'Algo deu errado.. tente novamente.'
                    });
                } else {
                    simpleAlert.show({
                        message: 'Página criada com sucesso!',
                        type: 'success'
                    });
                }
                data.onRequest = false;
                page.getPages();
            });
        },
        removePage: function removePage() {},
        resetForm: function resetForm() {
            data.pageRoute = data.pageTitle = data.pageSubtitle = "";
        },
        replaceWhiteSpaces: function replaceWhiteSpaces(e) {
            var nstr = e.target.value.replace(/\s/g, "-");
            e.target.value = nstr.toLocaleLowerCase();
        }
    },
    created: function created() {
        this.getPages();
    }
});

var albumData = {
    albums: [],
    photos: [],
    albumId: "",
    cookedDeletion: "",
    editingPhotoIdx: "none",
    editingPhotoText: "",
    editingAlbumTitle: "none",
    editingAlbumDescription: 'none',
    curAlbum: 'none',
    fileInputs: [0],
    cookedAlbum: ''
};

var alb = new Vue({
    el: "#album_pane",
    data: albumData,
    methods: {
        getAlbums: function getAlbums() {
            $.post('api/album/update', {
                exec: 'get_albums'
            }, null, 'json').then(function (r) {
                if (!r.err) {
                    albumData.albums = null;
                    albumData.albums = r;
                    alb.getPhotos(0);
                } else {
                    return simpleAlert.show({
                        message: 'Houve algum problema ao buscar álbuns..'
                    });
                }
            });
        },
        getPhotos: function getPhotos(idx) {
            if (albumData.fileInputs.length > 1) {
                $('#confirm_change').modal('show');
                albumData.cookedAlbum = idx;
            } else {
                $.post('api/albums', {
                    exec: "get_album",
                    albumId: albumData.albums[idx].id
                }, null, 'json').then(function (r) {
                    albumData.photos = null;
                    albumData.photos = r;
                    albumData.albumId = albumData.albums[idx].id;
                    albumData.curAlbum = albumData.albums[idx];
                    albumData.curAlbum.idx = idx;
                });
            }
        },
        resetForm: function resetForm() {
            albumData.fileInputs = [0];
            $($('input[type=file]')[1]).parent('label').removeClass('d-none');
            $($('input[type=file]')[1]).val("");
            this.getPhotos(albumData.cookedAlbum);
        },
        deletePhoto: function deletePhoto() {
            if (albumData.cookedDeletion != undefined) {
                $.post('api/album/update', {
                    exec: 'delete_photo',
                    id: albumData.photos[albumData.cookedDeletion].id
                }, null, 'json').then(function (r) {
                    var t = 'warn';

                    if (!r.err) {
                        t = 'success';
                        albumData.photos.splice(albumData.cookedDeletion, 1);
                    }

                    simpleAlert.show({
                        message: r.res,
                        type: t
                    });
                });
            }
        },

        saveTitle: function saveTitle() {
            $.post('api/album/update', {
                exec: 'update_album_title',
                name: albumData.curAlbum.name,
                id: albumData.curAlbum.id
            }, null, 'json').then(function (r) {
                var t = 'warn';
                if (!r.err) {
                    t = 'success';
                    albumData.albums[albumData.curAlbum.idx].name = albumData.curAlbum.name;
                    albumData.editingAlbumTitle = 'none';
                }
                simpleAlert.show({
                    message: r.res,
                    type: t
                });
            });
        },

        saveDescription: function saveDescription() {
            $.post('api/album/update', {
                exec: 'update_photo_description',
                id: albumData.photos[albumData.editingPhotoIdx].id,
                description: albumData.editingPhotoText
            }, null, 'json').then(function (r) {
                var t = 'warn';
                if (!r.err) {
                    t = 'success';
                    albumData.photos[albumData.editingPhotoIdx].desc = albumData.editingPhotoText;
                    albumData.editingPhotoText = "";
                    albumData.editingPhotoIdx = 'none';
                }
                simpleAlert.show({
                    message: r.res,
                    type: t
                });
            });
        },

        insertPhotosToAlbum: function insertPhotosToAlbum(el) {
            var form = $(el.target).parent('form')[0];

            var formData = new FormData(form);
            $.ajax({
                url: 'api/album/update',
                data: formData,
                type: 'POST',
                contentType: false, // NEEDED, DON'T OMIT THIS (requires jQuery 1.6+)
                processData: false, // NEEDED, DON'T OMIT THIS
                success: function success(r) {
                    var t = 'warn';
                    if (!r.err) {
                        t = 'success';
                        albumData.cookedAlbum = albumData.curAlbum.idx;
                        alb.resetForm();
                    }
                    simpleAlert.show({
                        message: r.res,
                        type: t
                    });
                }
            });
        },


        addPhotoToCurrentAlbum: function addPhotoToCurrentAlbum(evt) {
            var el = evt.target;
            var p = {
                url: URL.createObjectURL(el.files[0]),
                desc: 'Envie as fotos para alterar a descrição.',
                album: 'null',
                id: null
            };

            albumData.fileInputs.push(albumData.fileInputs.length);
            albumData.photos.push(p);
            $(el).parent('label').addClass('d-none');
        },

        updateAlbumDescription: function updateAlbumDescription() {
            $.post('api/album/update', {
                exec: 'update_album_description',
                id: albumData.curAlbum.id,
                description: albumData.curAlbum.desc
            }, null, 'json').then(function (r) {
                var t = 'warn';
                if (!r.err) {
                    t = 'success';
                    albumData.albums[albumData.curAlbum.idx].desc = albumData.curAlbum.desc;
                    albumData.editingAlbumDescription = 'none';
                }
                simpleAlert.show({
                    message: r.res,
                    type: t
                });
            });
        },
        updateThumbnail: function updateThumbnail(e) {
            var el = e.target;

            var formData = new FormData();
            formData.append('thumb', el.files[0]);
            formData.append('exec', 'update_album_thumbnail');
            formData.append('albumId', albumData.curAlbum.id);
            $('#album-thumbnail img').attr('src', 'assets/loading.gif');

            $.ajax({
                url: 'api/album/update',
                data: formData,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function success(r) {
                    var t = 'warn';
                    if (!r.err) {
                        t = 'success';

                        albumData.albums[albumData.curAlbum.idx].thumb = r.path;
                        $('#album-thumbnail img').attr('src', URL.createObjectURL(el.files[0]));
                    }
                    simpleAlert.show({
                        message: r.res,
                        type: t
                    });
                }
            });
        }
    },
    created: function created() {
        this.getAlbums();
    }
});

var deleteModal = new Vue({
    el: '#album_modal',
    data: {},

    methods: {
        deletePhoto: function deletePhoto() {
            alb.deletePhoto();
        }
    }
});
var changeModal = new Vue({
    el: '#confirm_change',
    data: {},

    methods: {
        resetForm: function resetForm() {
            alb.resetForm();
        }
    }
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHMvanMvYWRtaW4tcGFuZWwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLElBQUksT0FBTztBQUNQLFdBQU8sRUFEQTtBQUVQLGVBQVcsS0FGSjtBQUdQLGVBQVcsRUFISjtBQUlQLGtCQUFjLEVBSlA7QUFLUCxlQUFXLEVBTEo7QUFNUCxnQkFBWTtBQU5MLENBQVg7O0FBU0EsSUFBSSxPQUFPLElBQUksR0FBSixDQUFRO0FBQ2YsUUFBSSxhQURXO0FBRWYsVUFBTSxJQUZTO0FBR2YsYUFBUztBQUNMLGtCQUFVLG9CQUNWO0FBQ0ksZ0JBQUcsS0FBSyxTQUFSLEVBQW1CLE9BQU8sS0FBUDs7QUFFbkIsaUJBQUssU0FBTCxHQUFpQixJQUFqQjtBQUNBLGNBQUUsSUFBRixDQUFPLFlBQVAsRUFBcUI7QUFDakIsc0JBQU07QUFEVyxhQUFyQixFQUVHLElBRkgsRUFFUyxNQUZULEVBRWlCLElBRmpCLENBRXNCLFVBQVMsQ0FBVCxFQUFXO0FBQzdCLG9CQUFHLFVBQVUsQ0FBYixFQUFlO0FBQ1gsZ0NBQVksSUFBWixDQUFpQjtBQUNiLGlDQUFTO0FBREkscUJBQWpCO0FBR0gsaUJBSkQsTUFJSztBQUNELHlCQUFLLEtBQUwsR0FBYSxDQUFiO0FBQ0g7QUFDRCxxQkFBSyxTQUFMLEdBQWlCLEtBQWpCO0FBQ0gsYUFYRDtBQVlILFNBbEJJO0FBbUJMLG9CQUFZLHNCQUNaO0FBQ0ksZ0JBQUcsS0FBSyxTQUFMLElBQWtCLEtBQUssU0FBTCxDQUFlLE1BQWYsR0FBd0IsQ0FBN0MsRUFBZ0QsT0FBTyxZQUFZLElBQVosQ0FBaUI7QUFDcEUseUJBQVM7QUFEMkQsYUFBakIsQ0FBUDs7QUFJaEQsaUJBQUssU0FBTCxHQUFpQixJQUFqQjtBQUNBLGNBQUUsSUFBRixDQUFPLFlBQVAsRUFBcUI7QUFDakIsc0JBQU0sYUFEVztBQUVqQixzQkFBTTtBQUNGLDJCQUFPLEtB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QUFuRDtBQUNBLDBCQUFFLHNCQUFGLEVBQTBCLElBQTFCLENBQStCLEtBQS9CLEVBQXNDLElBQUksZUFBSixDQUFvQixHQUFHLEtBQUgsQ0FBUyxDQUFULENBQXBCLENBQXRDO0FBRUg7QUFDRCxnQ0FBWSxJQUFaLENBQWlCO0FBQ2IsaUNBQVMsRUFBRSxHQURFO0FBRWIsOEJBQU07QUFGTyxxQkFBakI7QUFLSDtBQXBCRSxhQUFQO0FBd0JIO0FBM01JLEtBSEs7QUFnTmQsYUFBUyxtQkFBVTtBQUNmLGFBQUssU0FBTDtBQUNIO0FBbE5hLENBQVIsQ0FBVjs7QUFxTkEsSUFBSSxjQUFjLElBQUksR0FBSixDQUFRO0FBQ3RCLFFBQUksY0FEa0I7QUFFdEIsVUFBTSxFQUZnQjs7QUFJdEIsYUFBUztBQUNMLG1CQURLLHlCQUNRO0FBQUMsZ0JBQUksV0FBSjtBQUFrQjtBQUQzQjtBQUphLENBQVIsQ0FBbEI7QUFRQSxJQUFJLGNBQWMsSUFBSSxHQUFKLENBQVE7QUFDdEIsUUFBSSxpQkFEa0I7QUFFdEIsVUFBTSxFQUZnQjs7QUFJdEIsYUFBUztBQUNMLGlCQURLLHVCQUNNO0FBQUMsZ0JBQUksU0FBSjtBQUFnQjtBQUR2QjtBQUphLENBQVIsQ0FBbEIiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJ2YXIgZGF0YSA9IHtcbiAgICBwYWdlczogW10sXG4gICAgb25SZXF1ZXN0OiBmYWxzZSxcbiAgICBwYWdlVGl0bGU6IFwiXCIsXG4gICAgcGFnZVN1YnRpdGxlOiBcIlwiLFxuICAgIHBhZ2VSb3V0ZTogXCJcIixcbiAgICBwYWdlU2VhcmNoOiBcIlwiLFxufVxuXG52YXIgcGFnZSA9IG5ldyBWdWUoe1xuICAgIGVsOiAnI3BhZ2VzX3BhbmUnLFxuICAgIGRhdGE6IGRhdGEsXG4gICAgbWV0aG9kczoge1xuICAgICAgICBnZXRQYWdlczogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZihkYXRhLm9uUmVxdWVzdCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICBkYXRhLm9uUmVxdWVzdCA9IHRydWU7XG4gICAgICAgICAgICAkLnBvc3QoJy9hcGkvcGFnZXMnLCB7XG4gICAgICAgICAgICAgICAgZXhlYzogJ3JlcXVlc3RfcGFnZXMnXG4gICAgICAgICAgICB9LCBudWxsLCAnanNvbicpLnRoZW4oZnVuY3Rpb24ocil7XG4gICAgICAgICAgICAgICAgaWYoJ2Vycm8nIGluIHIpe1xuICAgICAgICAgICAgICAgICAgICBzaW1wbGVBbGVydC5zaG93KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdIb3V2ZSB1bSBwcm9ibGVtYSBhbyBjYXJyZWdhciBzdWFzIHDDoWdpbmFzLi4nXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnBhZ2VzID0gcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGF0YS5vblJlcXVlc3QgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVQYWdlOiBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmKGRhdGEub25SZXF1ZXN0IHx8IGRhdGEucGFnZVJvdXRlLmxlbmd0aCA8IDMpIHJldHVybiBzaW1wbGVBbGVydC5zaG93KHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnU3VhIHJvdGEgbmVjZXNzaXRhIGRlIGFvIG1lbm9zIHRyw6pzIGNhcmFjdGVyZXMhJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRhdGEub25SZXF1ZXN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICQucG9zdCgnL2FwaS9wYWdlcycsIHtcbiAgICAgICAgICAgICAgICBleGVjOiAnY3JlYXRlX3BhZ2UnLFxuICAgICAgICAgICAgICAgIHBhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGRhdGEucGFnZVRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBzdWJ0aXRsZTogZGF0YS5wYWdlU3VidGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHJvdXRlOiBkYXRhLnBhZ2VSb3V0ZSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBudWxsLCAnanNvbicpLnRoZW4oZnVuY3Rpb24ocil7XG4gICAgICAgICAgICAgICAgaWYoJ2Vycm8nIGluIHIpe1xuICAgICAgICAgICAgICAgICAgICBzaW1wbGVBbGVydC5zaG93KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdBbGdvIGRldSBlcnJhZG8uLiB0ZW50ZSBub3ZhbWVudGUuJ1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgc2ltcGxlQWxlcnQuc2hvdyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnUMOhZ2luYSBjcmlhZGEgY29tIHN1Y2Vzc28hJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJ1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGF0YS5vblJlcXVlc3QgPSBmYWxzZVxuICAgICAgICAgICAgICAgIHBhZ2UuZ2V0UGFnZXMoKTtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZVBhZ2U6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuXG4gICAgICAgIH0sXG4gICAgICAgIHJlc2V0Rm9ybTogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICBkYXRhLnBhZ2VSb3V0ZSA9IGRhdGEucGFnZVRpdGxlID0gZGF0YS5wYWdlU3VidGl0bGUgPSBcIlwiO1xuICAgICAgICB9LFxuICAgICAgICByZXBsYWNlV2hpdGVTcGFjZXM6IGZ1bmN0aW9uKGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBuc3RyID0gIChlLnRhcmdldC52YWx1ZS5yZXBsYWNlKC9cXHMvZywgXCItXCIpKTtcbiAgICAgICAgICAgIGUudGFyZ2V0LnZhbHVlID0gbnN0ci50b0xvY2FsZUxvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBjcmVhdGVkOiBmdW5jdGlvbigpXG4gICAge1xuICAgICAgICB0aGlzLmdldFBhZ2VzKCk7XG4gICAgfVxufSlcblxubGV0IGFsYnVtRGF0YSA9IHtcbiAgICBhbGJ1bXM6IFtdLFxuICAgIHBob3RvczogW10sXG4gICAgYWxidW1JZDogXCJcIixcbiAgICBjb29rZWREZWxldGlvbjogXCJcIixcbiAgICBlZGl0aW5nUGhvdG9JZHg6IFwibm9uZVwiLFxuICAgIGVkaXRpbmdQaG90b1RleHQ6IFwiXCIsXG4gICAgZWRpdGluZ0FsYnVtVGl0bGU6IFwibm9uZVwiLFxuICAgIGVkaXRpbmdBbGJ1bURlc2NyaXB0aW9uOiAnbm9uZScsXG4gICAgY3VyQWxidW06ICdub25lJyxcbiAgICBmaWxlSW5wdXRzOiBbXG4gICAgICAgIDAsXG4gICAgXSxcbiAgICBjb29rZWRBbGJ1bTogJydcbn1cblxubGV0IGFsYiA9IG5ldyBWdWUoe1xuICAgIGVsOlwiI2FsYnVtX3BhbmVcIixcbiAgICBkYXRhOmFsYnVtRGF0YSxcbiAgICBtZXRob2RzOiB7XG4gICAgICAgIGdldEFsYnVtczogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICAkLnBvc3QoJ2FwaS9hbGJ1bS91cGRhdGUnLCB7XG4gICAgICAgICAgICAgICAgZXhlYzogJ2dldF9hbGJ1bXMnXG4gICAgICAgICAgICB9LG51bGwsICdqc29uJykudGhlbihmdW5jdGlvbihyKXtcbiAgICAgICAgICAgICAgICBpZighci5lcnIpe1xuICAgICAgICAgICAgICAgICAgICBhbGJ1bURhdGEuYWxidW1zID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgYWxidW1EYXRhLmFsYnVtcyA9IHI7XG4gICAgICAgICAgICAgICAgICAgIGFsYi5nZXRQaG90b3MoMClcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpbXBsZUFsZXJ0LnNob3coe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ0hvdXZlIGFsZ3VtIHByb2JsZW1hIGFvIGJ1c2NhciDDoWxidW5zLi4nXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIGdldFBob3RvczogZnVuY3Rpb24oaWR4KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZihhbGJ1bURhdGEuZmlsZUlucHV0cy5sZW5ndGggPiAxKXtcbiAgICAgICAgICAgICAgICAkKCcjY29uZmlybV9jaGFuZ2UnKS5tb2RhbCgnc2hvdycpO1xuICAgICAgICAgICAgICAgIGFsYnVtRGF0YS5jb29rZWRBbGJ1bSA9IGlkeDtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICQucG9zdCgnYXBpL2FsYnVtcycse1xuICAgICAgICAgICAgICAgICAgICBleGVjOiBcImdldF9hbGJ1bVwiLFxuICAgICAgICAgICAgICAgICAgICBhbGJ1bUlkOiBhbGJ1bURhdGEuYWxidW1zW2lkeF0uaWRcbiAgICAgICAgICAgICAgICB9LCBudWxsLCAnanNvbicpLnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxidW1EYXRhLnBob3RvcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGFsYnVtRGF0YS5waG90b3MgPSByO1xuICAgICAgICAgICAgICAgICAgICBhbGJ1bURhdGEuYWxidW1JZCA9IGFsYnVtRGF0YS5hbGJ1bXNbaWR4XS5pZDtcbiAgICAgICAgICAgICAgICAgICAgYWxidW1EYXRhLmN1ckFsYnVtID0gYWxidW1EYXRhLmFsYnVtc1tpZHhdO1xuICAgICAgICAgICAgICAgICAgICBhbGJ1bURhdGEuY3VyQWxidW0uaWR4ID0gaWR4O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSAgXG4gICAgICAgIH0sXG4gICAgICAgIHJlc2V0Rm9ybTogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICBhbGJ1bURhdGEuZmlsZUlucHV0cyA9IFswXTtcbiAgICAgICAgICAgICQoJCgnaW5wdXRbdHlwZT1maWxlXScpWzFdKS5wYXJlbnQoJ2xhYmVsJykucmVtb3ZlQ2xhc3MoJ2Qtbm9uZScpO1xuICAgICAgICAgICAgJCgkKCdpbnB1dFt0eXBlPWZpbGVdJylbMV0pLnZhbChcIlwiKTtcbiAgICAgICAgICAgIHRoaXMuZ2V0UGhvdG9zKGFsYnVtRGF0YS5jb29rZWRBbGJ1bSk7XG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZVBob3RvOiBmdW5jdGlvbiAoKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZihhbGJ1bURhdGEuY29va2VkRGVsZXRpb24gIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAkLnBvc3QoJ2FwaS9hbGJ1bS91cGRhdGUnLCB7XG4gICAgICAgICAgICAgICAgICAgIGV4ZWM6ICdkZWxldGVfcGhvdG8nLFxuICAgICAgICAgICAgICAgICAgICBpZDogYWxidW1EYXRhLnBob3Rvc1thbGJ1bURhdGEuY29va2VkRGVsZXRpb25dLmlkXG4gICAgICAgICAgICAgICAgfSwgbnVsbCwgJ2pzb24nKS50aGVuKGZ1bmN0aW9uKHIpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgdCA9ICd3YXJuJztcblxuICAgICAgICAgICAgICAgICAgICBpZighci5lcnIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdCA9ICdzdWNjZXNzJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsYnVtRGF0YS5waG90b3Muc3BsaWNlKGFsYnVtRGF0YS5jb29rZWREZWxldGlvbiwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBzaW1wbGVBbGVydC5zaG93KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHIucmVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogdFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2F2ZVRpdGxlOiBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgICQucG9zdCgnYXBpL2FsYnVtL3VwZGF0ZScsIHtcbiAgICAgICAgICAgICAgICBleGVjOid1cGRhdGVfYWxidW1fdGl0bGUnLFxuICAgICAgICAgICAgICAgIG5hbWU6IGFsYnVtRGF0YS5jdXJBbGJ1bS5uYW1lLFxuICAgICAgICAgICAgICAgIGlkOiBhbGJ1bURhdGEuY3VyQWxidW0uaWRcbiAgICAgICAgICAgIH0sIG51bGwsICdqc29uJykudGhlbihmdW5jdGlvbihyKXtcbiAgICAgICAgICAgICAgICB2YXIgdCA9ICd3YXJuJztcbiAgICAgICAgICAgICAgICBpZighci5lcnIpe1xuICAgICAgICAgICAgICAgICAgICB0ID0gJ3N1Y2Nlc3MnO1xuICAgICAgICAgICAgICAgICAgICBhbGJ1bURhdGEuYWxidW1zW2FsYnVtRGF0YS5jdXJBbGJ1bS5pZHhdLm5hbWUgPSBhbGJ1bURhdGEuY3VyQWxidW0ubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgYWxidW1EYXRhLmVkaXRpbmdBbGJ1bVRpdGxlID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzaW1wbGVBbGVydC5zaG93KHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogci5yZXMsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHRcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSxcblxuICAgICAgICBzYXZlRGVzY3JpcHRpb246IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgJC5wb3N0KCdhcGkvYWxidW0vdXBkYXRlJywge1xuICAgICAgICAgICAgICAgIGV4ZWM6ICd1cGRhdGVfcGhvdG9fZGVzY3JpcHRpb24nLFxuICAgICAgICAgICAgICAgIGlkOiBhbGJ1bURhdGEucGhvdG9zW2FsYnVtRGF0YS5lZGl0aW5nUGhvdG9JZHhdLmlkLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhbGJ1bURhdGEuZWRpdGluZ1Bob3RvVGV4dFxuICAgICAgICAgICAgfSwgbnVsbCwgJ2pzb24nKS50aGVuKGZ1bmN0aW9uKHIpe1xuICAgICAgICAgICAgICAgIHZhciB0ID0gJ3dhcm4nO1xuICAgICAgICAgICAgICAgIGlmKCFyLmVycil7XG4gICAgICAgICAgICAgICAgICAgIHQgPSAnc3VjY2Vzcyc7XG4gICAgICAgICAgICAgICAgICAgIGFsYnVtRGF0YS5waG90b3NbYWxidW1EYXRhLmVkaXRpbmdQaG90b0lkeF0uZGVzYyA9IGFsYnVtRGF0YS5lZGl0aW5nUGhvdG9UZXh0O1xuICAgICAgICAgICAgICAgICAgICBhbGJ1bURhdGEuZWRpdGluZ1Bob3RvVGV4dCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGFsYnVtRGF0YS5lZGl0aW5nUGhvdG9JZHggPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNpbXBsZUFsZXJ0LnNob3coe1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByLnJlcyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogdFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICB9LFxuXG4gICAgICAgIGluc2VydFBob3Rvc1RvQWxidW0oZWwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBmb3JtID0gJChlbC50YXJnZXQpLnBhcmVudCgnZm9ybScpWzBdO1xuXG4gICAgICAgICAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZm9ybSk7XG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHVybDogJ2FwaS9hbGJ1bS91cGRhdGUnLFxuICAgICAgICAgICAgICAgIGRhdGE6IGZvcm1EYXRhLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogZmFsc2UsIC8vIE5FRURFRCwgRE9OJ1QgT01JVCBUSElTIChyZXF1aXJlcyBqUXVlcnkgMS42KylcbiAgICAgICAgICAgICAgICBwcm9jZXNzRGF0YTogZmFsc2UsIC8vIE5FRURFRCwgRE9OJ1QgT01JVCBUSElTXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocil7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ID0gJ3dhcm4nO1xuICAgICAgICAgICAgICAgICAgICBpZighci5lcnIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdCA9ICdzdWNjZXNzJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsYnVtRGF0YS5jb29rZWRBbGJ1bSA9IGFsYnVtRGF0YS5jdXJBbGJ1bS5pZHg7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGIucmVzZXRGb3JtKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2ltcGxlQWxlcnQuc2hvdyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByLnJlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHRcbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG5cbiAgICAgICAgYWRkUGhvdG9Ub0N1cnJlbnRBbGJ1bTogZnVuY3Rpb24gKGV2dClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGVsID0gZXZ0LnRhcmdldDtcbiAgICAgICAgICAgIHZhciBwID0ge1xuICAgICAgICAgICAgICAgIHVybDpcdFVSTC5jcmVhdGVPYmplY3RVUkwoZWwuZmlsZXNbMF0pLFxuICAgICAgICAgICAgICAgIGRlc2M6XHQnRW52aWUgYXMgZm90b3MgcGFyYSBhbHRlcmFyIGEgZGVzY3Jpw6fDo28uJyxcbiAgICAgICAgICAgICAgICBhbGJ1bTpcdCdudWxsJyxcbiAgICAgICAgICAgICAgICBpZDogbnVsbFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYWxidW1EYXRhLmZpbGVJbnB1dHMucHVzaChhbGJ1bURhdGEuZmlsZUlucHV0cy5sZW5ndGgpXG4gICAgICAgICAgICBhbGJ1bURhdGEucGhvdG9zLnB1c2gocCk7XG4gICAgICAgICAgICAkKGVsKS5wYXJlbnQoJ2xhYmVsJykuYWRkQ2xhc3MoJ2Qtbm9uZScpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHVwZGF0ZUFsYnVtRGVzY3JpcHRpb246IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgJC5wb3N0KCdhcGkvYWxidW0vdXBkYXRlJywge1xuICAgICAgICAgICAgICAgIGV4ZWM6ICd1cGRhdGVfYWxidW1fZGVzY3JpcHRpb24nLFxuICAgICAgICAgICAgICAgIGlkOiBhbGJ1bURhdGEuY3VyQWxidW0uaWQsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGFsYnVtRGF0YS5jdXJBbGJ1bS5kZXNjXG4gICAgICAgICAgICB9LCBudWxsLCAnanNvbicpLnRoZW4oZnVuY3Rpb24ocil7XG4gICAgICAgICAgICAgICAgdmFyIHQgPSAnd2Fybic7XG4gICAgICAgICAgICAgICAgaWYoIXIuZXJyKXtcbiAgICAgICAgICAgICAgICAgICAgdCA9ICdzdWNjZXNzJztcbiAgICAgICAgICAgICAgICAgICAgYWxidW1EYXRhLmFsYnVtc1thbGJ1bURhdGEuY3VyQWxidW0uaWR4XS5kZXNjID0gYWxidW1EYXRhLmN1ckFsYnVtLmRlc2M7XG4gICAgICAgICAgICAgICAgICAgIGFsYnVtRGF0YS5lZGl0aW5nQWxidW1EZXNjcmlwdGlvbiA9ICdub25lJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2ltcGxlQWxlcnQuc2hvdyh7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHIucmVzLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiB0XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZVRodW1ibmFpbDogZnVuY3Rpb24oZSlcbiAgICAgICAge1xuICAgICAgICAgICAgbGV0IGVsID0gZS50YXJnZXQ7XG5cbiAgICAgICAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCd0aHVtYicsIGVsLmZpbGVzWzBdKTtcbiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZXhlYycsICd1cGRhdGVfYWxidW1fdGh1bWJuYWlsJyk7XG4gICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2FsYnVtSWQnLCBhbGJ1bURhdGEuY3VyQWxidW0uaWQpO1xuICAgICAgICAgICAgJCgnI2FsYnVtLXRodW1ibmFpbCBpbWcnKS5hdHRyKCdzcmMnLCAnYXNzZXRzL2xvYWRpbmcuZ2lmJyk7XG5cbiAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgdXJsOiAnYXBpL2FsYnVtL3VwZGF0ZScsXG4gICAgICAgICAgICAgICAgZGF0YTogZm9ybURhdGEsXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZSwgXG4gICAgICAgICAgICAgICAgcHJvY2Vzc0RhdGE6IGZhbHNlLCBcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSAnd2Fybic7XG4gICAgICAgICAgICAgICAgICAgIGlmKCFyLmVycil7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gJ3N1Y2Nlc3MnO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGJ1bURhdGEuYWxidW1zW2FsYnVtRGF0YS5jdXJBbGJ1bS5pZHhdLnRodW1iID0gci5wYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FsYnVtLXRodW1ibmFpbCBpbWcnKS5hdHRyKCdzcmMnLCBVUkwuY3JlYXRlT2JqZWN0VVJMKGVsLmZpbGVzWzBdKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzaW1wbGVBbGVydC5zaG93KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHIucmVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogdFxuICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcblxuICAgICAgICB9XG4gICAgfSxcbiAgICBjcmVhdGVkOiBmdW5jdGlvbigpe1xuICAgICAgICB0aGlzLmdldEFsYnVtcygpO1xuICAgIH1cbn0pXG5cbmxldCBkZWxldGVNb2RhbCA9IG5ldyBWdWUoe1xuICAgIGVsOiAnI2FsYnVtX21vZGFsJyxcbiAgICBkYXRhOiB7fSxcblxuICAgIG1ldGhvZHM6IHtcbiAgICAgICAgZGVsZXRlUGhvdG8oKXthbGIuZGVsZXRlUGhvdG8oKX1cbiAgICB9XG59KVxubGV0IGNoYW5nZU1vZGFsID0gbmV3IFZ1ZSh7XG4gICAgZWw6ICcjY29uZmlybV9jaGFuZ2UnLFxuICAgIGRhdGE6IHt9LFxuXG4gICAgbWV0aG9kczoge1xuICAgICAgICByZXNldEZvcm0oKXthbGIucmVzZXRGb3JtKCl9XG4gICAgfVxufSlcbiJdfQ==
